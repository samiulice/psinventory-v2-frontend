<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Income Statement</title>

    <!-- Bootstrap -->
    <link href="src/assets/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="src/assets/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="src/assets/vendors/nprogress/nprogress.css" rel="stylesheet">

    <!-- bootstrap-progressbar -->
    <link href="src/assets/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
    <!-- JQVMap -->
    <link href="src/assets/vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet" />
    <!-- bootstrap-daterangepicker -->
    <link href="src/assets/vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="src/assets/vendors/iCheck/skexpenses/flat/green.css" rel="stylesheet">
    <!-- Datatables -->
    <link href="src/assets/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
    <link href="src/assets/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css" rel="stylesheet">
    <link href="src/assets/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css" rel="stylesheet">
    <link href="src/assets/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
    <link href="src/assets/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="src/assets/css/custom.min.css" rel="stylesheet">
    <link href="src/assets/css/income-statement.css" rel="stylesheet">
    <!-- sweetalert2 style -->
    <link rel="stylesheet" href="src/assets/sweetalert2/sweetalert2.min.css">
</head>

<body class="nav-md">
    <div class="container body">
        <div class="main_container">
            <div class="col-md-3 left_col menu_fixed">
                <div class="left_col scroll-view">
                    <div class="navbar nav_title" style="border: 0;">
                        <a href="index.html" class="site_title"><span>PS INVENTORY</span></a>
                    </div>

                    <div class="clearfix"></div>

                    <!-- menu profile quick info -->
                    <div class="profile clearfix">
                        <div class="profile_pic">
                            <img src="https://psinventory-v2.onrender.com/images/logo.png" alt="..."
                                class="img-circle profile_img">
                        </div>
                        <div class="profile_info">
                            <span>Welcome,</span>
                            <h2 id="profile-name"></h2>
                        </div>
                    </div>
                    <!-- /menu profile quick info -->

                    <br />
                    <!-- sidebar menu -->
                    <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
                        <div class="menu_section">
                            <ul class="nav side-menu">
                                <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="index.html">Dashboard</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-cogs"></i> MIS <span class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="customer-list.html">Customer List</a></li>
                                        <li><a href="supplier-list.html">Supplier List</a></li>
                                        <li><a href="employee-list.html">Employee List</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-table"></i> Inventory <span
                                            class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="sale.html">Sale</a></li>
                                        <li><a href="sale-return.html">Sale Return</a></li>
                                        <li><a href="purchase.html">Purchase</a></li>
                                        <li><a href="purchase-return.html">Purchase Return</a></li>
                                        <li><a href="warranty.html">Warranty</a></li>
                                        <li><a href="service.html">Service</a></li>
                                        <li><a href="memo-list.html">Memo List</a></li>
                                        <li><a href="transaction-posting.html">Transaction Posting</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-bar-chart-o"></i> Accounts <span
                                            class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li><a href="receive-collection.html">Receive & Collection</a></li>
                                        <li><a href="payment.html">Payment</a></li>
                                        <li><a href="expenses.html">Expenses</a></li>
                                        <li><a href="investment.html">Investment</a></li>
                                    </ul>
                                </li>
                                <li><a><i class="fa fa-file-text"></i>Inventory Reports <span
                                            class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li class="sub_menu"><a href="stock-report.html">Stock Report</a></li>
                                        <li class="sub_menu"><a href="stock-alert-report.html">Stock Alert Report</a>
                                        </li>
                                        <li class="sub_menu"><a href="purchase-history.html">Purchase History</a></li>
                                        <li class="sub_menu"><a href="sales-history.html">Sales History</a></li>
                                        <li class="sub_menu"><a href="product-list.html">Product List</a></li>
                                        <li class="sub_menu"><a href="brand-list.html">Brand List</a></li>
                                        <li class="sub_menu"><a href="category-list.html">Category List</a></li>
                                        <li class="sub_menu"><a href="service-list.html">Service List</a></li>
                                    </ul>
                                </li>

                                <li><a><i class="fa fa-file-text"></i>Accounts Reports <span
                                            class="fa fa-chevron-down"></span></a>
                                    <ul class="nav child_menu">
                                        <li class="sub_menu"><a href="transaction-history.html">Transaction History</a>
                                        </li>
                                        <li class="sub_menu"><a href="customer-due-report.html">Customer Due Report</a>
                                        </li>
                                        <li class="sub_menu"><a href="supplier-due-report.html">Supplier Due Report</a>
                                        </li>
                                        <li class="sub_menu"><a href="ledger-book-summary.html">Ledger Book(SUMMARY)</a>
                                        </li>
                                        <li class="sub_menu"><a href="ledger-book-details.html">Ledger Book(DETAILS)</a>
                                        </li>
                                        <li class="sub_menu"><a href="expense-categories.html">Expenses Category</a>
                                        </li>
                                        <li class="sub_menu"><a href="expense-history.html">Expenses History</a></li>
                                        <li class="sub_menu"><a href="income-statement.html">Income Statement</a></li>
                                        <li class="sub_menu"><a href="top-sheet.html">TOP Sheet</a></li>
                                        <li class="sub_menu"><a href="trial-balance.html">Trial Balance</a></li>
                                        <li class="sub_menu"><a href="balance-sheet.html">Balance Sheet</a></li>
                                    </ul>
                                </li>

                            </ul>
                        </div>
                    </div>
                    <!-- /sidebar menu -->

                    <!-- /menu footer buttons -->
                    <div class="sidebar-footer hidden-small">
                        <a data-toggle="tooltip" data-placement="top" title="Settings" href="settings.html">
                            <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
                        </a>
                        <a data-toggle="tooltip" data-placement="top" title="Relaunch"
                            onclick="window.runtime.WindowReloadApp()">
                            <span class="glyphicon glyphicon-home" aria-hidden="true"></span>
                        </a>
                        <a data-toggle="tooltip" data-placement="top" title="Company Info" href="company-info.html">
                            <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                        </a>
                        <a data-toggle="tooltip" data-placement="top" title="Logout" onclick="terminateSession()">
                            <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
                        </a>
                    </div>
                    <!-- /menu footer buttons -->
                </div>
            </div>

            <!-- page content -->
            <div id="page-content" class="right_col" role="main">
                <div class="clearfix"></div>
                <div class="x_panel">
                    <div class="x_title">
                        <div class="col-md-4 col-sm-4 col-xs-12 form-group has-feedback">
                            <label for="start_date">Start Date *:</label>
                            <input type="text" id="start_date" class="form-control has-feedback-left"
                                placeholder="Select Date" aria-describedby="inputSuccess2Status4" required>
                            <i style="color: rgba(0, 0, 0, 1);" class="fa fa-calendar form-control-feedback left "
                                aria-hidden="true"></i>

                        </div>
                        <div class="col-md-4 col-sm-4 col-xs-12 form-group has-feedback">
                            <label for="end_date">End Date *:</label>
                            <input type="text" id="end_date" class="form-control has-feedback-left"
                                placeholder="Select Date" aria-describedby="inputSuccess2Status4" required>
                            <i style="color: rgba(0, 0, 0, 1);" class="fa fa-calendar form-control-feedback left "
                                aria-hidden="true"></i>

                        </div>
                        <div class="col-md-4 col-sm-4 col-xs-12" style="margin-top: 24px;">
                            <button type="button" class="btn btn-sm btn-dark pull-left"
                                onclick="generateIncomeStatement()">Get</button>
                            <button type="button" id="printBtn" class="btn btn-sm btn-dark pull-left d-none"
                                onclick="printIncomeStatement()">Print</button>
                        </div>
                        <div class="clearfix"></div>
                    </div>

                    <div id="income-statement-section" style="all:unset">
                        <!-- Will be updated by JS DOM -->
                    </div>
                </div>
            </div>
            <!-- /page content -->
        </div>
    </div>

    <!-- jQuery -->
    <script src="src/assets/vendors/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="src/assets/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="src/assets/vendors/fastclick/lib/fastclick.js"></script>
    <!-- NProgress -->
    <script src="src/assets/vendors/nprogress/nprogress.js"></script>
    <!-- Chart.js -->
    <script src="src/assets/vendors/Chart.js/dist/Chart.min.js"></script>
    <!-- gauge.js -->
    <script src="src/assets/vendors/gauge.js/dist/gauge.min.js"></script>
    <!-- bootstrap-progressbar -->
    <script src="src/assets/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
    <!-- iCheck -->
    <script src="src/assets/vendors/iCheck/icheck.min.js"></script>
    <!-- Skycons -->
    <script src="src/assets/vendors/skycons/skycons.js"></script>
    <!-- Flot -->
    <script src="src/assets/vendors/Flot/jquery.flot.js"></script>
    <script src="src/assets/vendors/Flot/jquery.flot.pie.js"></script>
    <script src="src/assets/vendors/Flot/jquery.flot.time.js"></script>
    <script src="src/assets/vendors/Flot/jquery.flot.stack.js"></script>
    <script src="src/assets/vendors/Flot/jquery.flot.resize.js"></script>
    <!-- Flot plugexpenses -->
    <script src="src/assets/vendors/flot.orderbars/js/jquery.flot.orderBars.js"></script>
    <script src="src/assets/vendors/flot-spline/js/jquery.flot.spline.min.js"></script>
    <script src="src/assets/vendors/flot.curvedlines/curvedLines.js"></script>
    <!-- DateJS -->
    <script src="src/assets/vendors/DateJS/build/date.js"></script>
    <!-- JQVMap -->
    <script src="src/assets/vendors/jqvmap/dist/jquery.vmap.js"></script>
    <script src="src/assets/vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>
    <script src="src/assets/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script>
    <!-- Validator JS  -->
    <script src="src/assets/vendors/validator/validator.js"></script>
    <!-- bootstrap-daterangepicker -->
    <script src="src/assets/vendors/moment/min/moment.min.js"></script>
    <script src="src/assets/vendors/bootstrap-daterangepicker/daterangepicker.js"></script>

    <!-- iCheck -->
    <script src="src/assets/vendors/iCheck/icheck.min.js"></script>

    <!-- Custom Theme Scripts -->
    <script src="src/assets/js/custom.js"></script>
    <script src="src/assets/js/swal-popup-form.js"></script>
    <script src="src/assets/js/app.js"></script>

    <!-- sweetalert2 script -->
    <script src="src/assets/sweetalert2/sweetalert2.all.min.js"></script>
    <script>
        let startDate, endDate, summary, expenses, company, net_sales, cost_of_goods_sold, total_operating_expenses;
        window.addEventListener("DOMContentLoaded", () => {
            initSingleDatePicker('#start_date')
            initSingleDatePicker('#end_date')
        })

        function generateIncomeStatement() {
            //hide print btn initially
            document.getElementById("printBtn").classList.add('d-none');
            //get the date ranges

            startDate = document.getElementById("start_date").value;
            endDate = document.getElementById("end_date").value;
            // console.log("selected date: ", startDate, endDate)
            //fetch income statement data from backend
            const requestOptions = {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + localStorage.getItem('psitoken')
                },

                body: JSON.stringify({
                    start_date: startDate,
                    end_date: endDate
                })
            }
            fetch(`${api}/api/v2/reports/accounts/income-statement`, requestOptions)
                .then(response => response.json())
                .then(data => {
                    if (data.error === true) {
                        console.log(data)
                        if (data.message.includes("no row")) {
                            Swal.fire({
                                title: "No data available",
                                icon: "success",
                                confirmButtonText: '<i class="fa fa-times"></i> Close'
                            });
                        } else {
                            Swal.fire({
                                title: "Internal Server Error",
                                text: "Contact to developer",
                                icon: "error",
                                confirmButtonText: '<i class="fa fa-times"></i> Close'
                            });
                        }
                        return
                    }
                    summary = data.summary;
                    expenses = data.expenses;
                    company = data.company_profile;
                    company.name = company.name.replace(":::", " ")
                    console.log(data)
                    updateIncomeStatement()
                    document.getElementById("printBtn").classList.remove('d-none');

                })
                .catch(function (error) {
                    console.error('Error fetching data:', error);
                });
        }

        function updateIncomeStatement() {
            net_sales = summary.total_sales - summary.total_sale_returns - summary.sales_discount;
            cost_of_goods_sold = summary.total_purchases - summary.total_purchase_returns - summary.purchases_discount - summary.initial_stock_value;
            total_operating_expenses = 0;
            let expense_list = ""
            let exp = Object.entries(expenses);
            exp.forEach(([key, value]) => {
                total_operating_expenses += value
                expense_list += `
                <tr class=xl6712647 height=17 style='height:12.75pt'>
                    <td height=17 class=xl6712647 style='height:12.75pt'></td>
                    <td class=xl6712647></td>
                    <td class=xl7212647>${toTitleCase(key, "_")}</td>
                    <td class=xl7312647 >${value}</td>
                </tr>
                `
            });

            let income_statement_content = `
                <div id="Income statement_12647" align=center x:publishsource="Excel">
                    <table  border=0 cellpadding=0 cellspacing=0 width=514 class=xl6612647
                        style='border-collapse:collapse;table-layout:fixed;width:385pt'>
                        <col class=xl6612647 width=19 style='mso-width-source:userset;mso-width-alt: 608;width:14pt'>
                        <col class=xl6612647 width=43 style='mso-width-source:userset;mso-width-alt: 1376;width:32pt'>
                        <col class=xl6612647 width=325 style='mso-width-source:userset;mso-width-alt: 10400;width:244pt'>
                        <col class=xl6612647 width=127 style='mso-width-source:userset;mso-width-alt: 4064;width:95pt'>
                        
                        <tr class=xl6712647 height=27 style='mso-height-source:userset;height:20.25pt'>
                            <td height=27 class=xl8112647 style='height:30pt'></td>
                            <td class=xl6712647 colspan=3 style="text-align:center; color:#3A5D9C"><h2>${company.name}</h2></td>
                        </tr>
                        <tr class=xl6712647 height=27 style='mso-height-source:userset;height:12.75pt'>
                            <td height=27 class=xl8112647 style='height:12.75pt'></td>
                            <td class=xl6712647 colspan=3 style="text-align:center;"><h4>Income Statement</h4></td>
                        </tr>
                        <tr class=xl6712647 height=27 style='mso-height-source:userset;height:12.75pt'>
                            <td height=27 class=xl8112647 style='height:12.75pt'></td>
                            <td class=xl6712647 colspan=3 style="text-align:center;"><label>For the Period Ending: ${moment(endDate).format('MMM D, YYYY')}</label></td>
                        </tr>
                        <tr class=xl6712647 height=17 style='mso-height-source:userset;height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=17 style='mso-height-source:userset;height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl7112647 colspan=3>Revenue</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='mso-height-source:userset;height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Gross sales</td>
                            <td class=xl7312647><span style='mso-spacerun:yes'>
                                </span>${summary.total_sales}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Less sales returns</td>
                            <td class=xl7312647 style='border-top:none'><span style='mso-spacerun:yes'> </span>(${summary.total_sale_returns})
                            </td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Less Allowances</td>
                            <td class=xl7312647 style='border-top:none'><span style='mso-spacerun:yes'>
                                </span>(${summary.sales_discount})</td>
                        </tr>
                        <tr class=xl6712647 height=21 style='height:15.75pt'>
                            <td height=21 class=xl6712647 style='height:15.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7812647>Net Sales</td>
                            <td class=xl7412647><span style='mso-spacerun:yes'>
                                </span>${net_sales} </td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=24 style='height:18.0pt'>
                            <td height=24 class=xl6712647 style='height:18.0pt'></td>
                            <td class=xl7112647 colspan=2>Cost of Goods Sold</td>
                            <td class=xl7112647>&nbsp;</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Goods purchased</td>
                            <td class=xl7312647><span style='mso-spacerun:yes'>
                                </span>${summary.total_purchases}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Less purchase returns</td>
                            <td class=xl7312647 style='border-top:none'><span style='mso-spacerun:yes'>
                                </span>(${summary.total_purchase_returns})</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Less Allowances</td>
                            <td class=xl7312647 style='border-top:none'><span style='mso-spacerun:yes'>
                                </span>(${summary.purchases_discount})</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Total available Goods</td>
                            <td class=xl7312647 style='border-top:none'><span style='mso-spacerun:yes'>
                                </span>(${summary.initial_stock_value})</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7812647>Cost of Goods Sold</td>
                            <td class=xl7412647><span style='mso-spacerun:yes'>
                                </span>${cost_of_goods_sold}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=21 style='height:15.75pt'>
                            <td height=21 class=xl6712647 style='height:15.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7812647>Gross Profit (Loss)</td>
                            <td class=xl7412647><span style='mso-spacerun:yes'>
                                </span>${net_sales - cost_of_goods_sold}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=24 style='height:18.0pt'>
                            <td height=24 class=xl6812647 style='height:18.0pt'>[42]</td>
                            <td class=xl7112647 colspan=2>Expenses</td>
                            <td class=xl7112647>&nbsp;</td>
                        </tr>
                        ${expense_list}
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7812647>Total Operating Expense</td>
                            <td class=xl7412647><span style='mso-spacerun:yes'>
                                </span>${total_operating_expenses}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=21 style='height:15.75pt'>
                            <td height=21 class=xl6712647 style='height:15.75pt'></td>
                            <td colspan=2 class=xl8312647>Operating Income (Loss)</td>
                            <td class=xl7412647><span style='mso-spacerun:yes'>
                                </span>${net_sales - cost_of_goods_sold - total_operating_expenses}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Non-operating revenues,expenses</td>
                            <td class=xl7312647><span style='mso-spacerun:yes'>
                                </span>${expenses.non_operating_income}</td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl7212647>Non-operating expenses, losses</td>
                            <td class=xl7312647><span style='mso-spacerun:yes'>
                                </span>(${expenses.non_operating_expense})</td>
                        </tr>

                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=22 style='height:16.5pt'>
                            <td height=22 class=xl6712647 style='height:16.5pt'></td>
                            <td colspan=2 class=xl8212647>Net Income</td>
                            <td class=xl7712647><span style='mso-spacerun:yes'>
                                </span>${net_sales - cost_of_goods_sold - total_operating_expenses + expenses.non_operating_income - expenses.non_operating_expense}
                            </td>
                        </tr>

                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt'></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                            <td class=xl6712647></td>
                        </tr>
                        <tr class=xl6712647 height=17 style='height:12.75pt'>
                            <td height=17 class=xl6712647 style='height:12.75pt; font-weight:400;text-align:center' colspan=4><label>&#169 2024 <span style='font-weight:bold;'>${company.name}</span>. All rights reserved.</label></td>
                        </tr>
                    </table>

                </div>
            `

            //set document content to the income statement section
            document.getElementById("income-statement-section").innerHTML = income_statement_content;


            let content = `
            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"
                xmlns="http://www.w3.org/TR/REC-html40">

            <head>
                <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
                <meta name=ProgId content=Excel.Sheet>
                <meta name=Generator content="Microsoft Excel 15">
                <style id="Income statement_12647_Styles">
                    .xl6612647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: bottom;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        white-space: nowrap;
                    }

                    .xl6712647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        white-space: nowrap;
                    }

                    .xl6812647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: white;
                        font-size: 2.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: right;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        white-space: nowrap;
                    }

                    .xl6912647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 2.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        white-space: nowrap;
                    }

                    .xl7012647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: white;
                        font-size: 14.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        background: #3A5D9C;
                        mso-pattern: black none;
                        mso-protection: unlocked visible;
                        white-space: nowrap;
                    }

                    .xl7112647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: white;
                        font-size: 14.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        background: #3A5D9C;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl7212647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        mso-protection: unlocked visible;
                        white-space: nowrap;
                    }

                    .xl7312647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        text-align: right;
                        padding-right: 5px;
                        font-family: Arial, sans-serif;
                        text-align: general;
                        vertical-align: middle;
                        border: .5pt solid silver;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        mso-protection: unlocked visible;
                        white-space: nowrap;
                    }

                    .xl7412647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 12.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        text-align: right;
                        padding-right: 5px;
                        font-family: Arial, sans-serif;
                        text-align: general;
                        vertical-align: middle;
                        border-top: .5pt solid windowtext;
                        border-right: none;
                        border-bottom: none;
                        border-left: none;
                        background: #F2F2F2;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl7512647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        background: #F2F2F2;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl7612647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: white;
                        font-size: 2.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        white-space: nowrap;
                    }

                    .xl7712647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 12.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        text-align: right;
                        padding-right: 5px;
                        vertical-align: middle;
                        border-top: .5pt solid windowtext;
                        border-right: none;
                        border-bottom: 2.0pt double windowtext;
                        border-left: none;
                        background: #D3DDEF;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl7812647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 12.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        background: #F2F2F2;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl7912647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 16.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: general;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        mso-protection: unlocked visible;
                        white-space: nowrap;
                    }

                    .xl8012647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        text-align: right;
                        padding-right: 5px;
                        vertical-align: middle;
                        border-top: .5pt solid windowtext;
                        border-right: none;
                        border-bottom: none;
                        border-left: none;
                        background: #F2F2F2;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl8112647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 10.0pt;
                        font-weight: 400;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: left;
                        vertical-align: middle;
                        mso-background-source: auto;
                        mso-pattern: auto;
                        white-space: nowrap;
                    }

                    .xl8212647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 12.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: left;
                        vertical-align: middle;
                        background: #D3DDEF;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }

                    .xl8312647 {
                        padding-top: 1px;
                        padding-right: 1px;
                        padding-left: 1px;
                        mso-ignore: padding;
                        color: windowtext;
                        font-size: 12.0pt;
                        font-weight: 700;
                        font-style: normal;
                        text-decoration: none;
                        font-family: Arial, sans-serif;
                        mso-font-charset: 0;
                        mso-number-format: General;
                        text-align: left;
                        vertical-align: middle;
                        background: #F2F2F2;
                        mso-pattern: black none;
                        white-space: nowrap;
                    }
                </style>
            </head>

            <body>
                ${income_statement_content}
            </body>

            </html>`

            document.getElementById("printBtn").addEventListener('click', () => {
                // Create an iframe to load the content
                const iframe = document.createElement('iframe');
                document.body.appendChild(iframe);
                iframe.style.display = 'none';
                const doc = iframe.contentDocument || iframe.contentWindow.document;
                doc.open();
                doc.write(content);
                doc.close();

                // Wait for content to load and then print
                iframe.onload = () => {
                    document.title = 'income_statement_' + moment().format('D_MMM_YYYY_hh_mm_ss')
                    iframe.contentWindow.print();
                    document.body.removeChild(iframe);
                };
            })

        }
    </script>
</body>

</html>